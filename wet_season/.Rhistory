select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
source("load_paths.R")
names(Kano_data) <- gsub(" ", "", new_names$new_name)
hh_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
View(hh_answers)
hh_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifesle(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHAMED", "00003",serial_number))))
hh_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHAMED", "00003",serial_number))))
metropolis_name
write.csv(hh_answers, file.path(cleaned_data, metropolis_name,"Kano_household_level_information.csv"))
individual_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(-1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
View(individual_answers)
hh_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Household List") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
View(individual_answers)
source("load_paths.R")
names(Kano_data) <- gsub(" ", "", new_names$new_name)
View(hh_answers)
hh_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHAMED", "00003",serial_number))))
View(hh_answers)
View(Kano_data )
hh_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
write.csv(hh_answers, file.path(cleaned_data, metropolis_name,"Kano_household_level_information.csv"))
individual_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(-1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
View(individual_answers)
names(hh_answers)
Kano_data$line_number01
Kano_data_modified <- Kano_data %>%
mutate(repeat_instrument = ifelse(line_number01 != "", "Household List",
ifelse(line_number02 != "", "Section 3 Malaria Screening",
ifelse(complete02 != "", "Vh",
ifelse( complete11 != "","Net Inspection",
ifelse(complete07 != "", "Tfhi", ""))))))
View(Kano_data_modified )
Kano_data_modified <- Kano_data %>%
mutate(repeat_instrument = ifelse(line_number01 != "", "Household List",
ifelse(line_number02 != "", "Section 3 Malaria Screening",
ifelse(complete02 != "", "Vh",
ifelse( complete11 != "","Net Inspection",
ifelse(complete07 != "", "Tfhi", "")))))) %>%
select(serial_number, repeat_instrument, everything())
hh_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
write.csv(hh_answers, file.path(cleaned_data, metropolis_name,"Kano_household_level_information.csv"))
individual_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(-1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
hh_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Household List") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
Kano_data_modified <- Kano_data %>%
mutate(repeat_instrument = ifelse(line_number01 != "", "Household List",
ifelse(line_number02 != "", "Section 3 Malaria Screening",
ifelse(complete02 != "", "Vh",
ifelse( complete11 != "","Net Inspection",
ifelse(complete07 != "", "Tfhi", "")))))) %>%
select(serial_number, repeat_instrument, everything())
hh_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
write.csv(hh_answers, file.path(cleaned_data, metropolis_name,"Kano_household_level_information.csv"))
individual_answers <- Kano_data %>%
# household level information
group_by(serial_number) %>%
slice(-1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
hh_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Household List") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
individual_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(-1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
hh_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Household List") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
View(hh_individual_answers)
dim(hh_individual_answers)
length(unique(hh_individual_answers$household_residents))
length(unique(hh_individual_answers$serial_number))
write.csv(hh_individual_answers, file.path(cleaned_data,
"Kano_individual_level_information.csv"))
visitos_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Visitors") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
write.csv(hh_individual_answers, file.path(cleaned_data, metropolis_name,
"Kano_individual_level_information.csv"))
dim(visitos_individual_answers)
Kano_data_modified <- Kano_data %>%
mutate(repeat_instrument = ifelse(line_number01 != "", "Household List",
ifelse(line_number02 != "", "Section 3 Malaria Screening",
ifelse(complete03 != "", "Visitors",
ifelse( complete11 != "","Net Inspection",
ifelse(spent_the_night_visitors != "", "Tfhi",
ifelse(complete07 != "", "Tfhi", ""))))))) %>%
select(serial_number, repeat_instrument, everything())
Kano_data_modified <- Kano_data %>%
mutate(repeat_instrument = ifelse(line_number01 != "", "Household List",
ifelse(line_number02 != "", "Section 3 Malaria Screening",
ifelse(complete03 != "", "Visitors",
ifelse( complete11 != "","Net Inspection",
ifelse(spent_the_night_visitors != "", "Tfhi",
ifelse(complete07 != "", "Vh", ""))))))) %>%
select(serial_number, repeat_instrument, everything())
hh_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
write.csv(hh_answers, file.path(cleaned_data, metropolis_name,"Kano_household_level_information.csv"))
individual_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(-1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
hh_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Household List") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
write.csv(hh_individual_answers, file.path(cleaned_data, metropolis_name,
"Kano_individual_level_information.csv"))
visitos_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Vh") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
dim(visitos_individual_answers)
write.csv(visitos_individual_answers, file.path(cleaned_data,  metropolis_name,
"Kano_Visitors_level_information.csv"))
Tfhi_individual_answers <- individual_answers %>%
# traveller's  data
filter(repeat_instrument == "Tfhi") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
dim(Tfhi_individual_answers)
individual_answers
Kano_data_modified <- Kano_data %>%
mutate(repeat_instrument = ifelse(line_number01 != "", "Household List",
ifelse(line_number02 != "", "Section 3 Malaria Screening",
ifelse(complete03 != "", "Visitors",
ifelse( complete11 != "","Net Inspection",
ifelse(complete06 != "" | complete07 != "", "Tfhi",
ifelse(complete07 != "", "Vh", ""))))))) %>%
select(serial_number, repeat_instrument, everything())
hh_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
individual_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(-1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
hh_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Household List") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
Tfhi_individual_answers <- individual_answers %>%
# traveller's  data
filter(repeat_instrument == "Tfhi") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
View(Tfhi_individual_answers)
Kano_data_modified <- Kano_data %>%
mutate(repeat_instrument = ifelse(line_number01 != "", "Household List",
ifelse(line_number02 != "", "Section 3 Malaria Screening",
ifelse(complete03 != "", "Visitors",
ifelse( complete11 != "","Net Inspection",
ifelse(complete06 != "" , "", "Tfhi",
ifelse(complete07 != "", "Vh", ""))))))) %>%
select(serial_number, repeat_instrument, everything())
Kano_data_modified <- Kano_data %>%
mutate(repeat_instrument = ifelse(line_number01 != "", "Household List",
ifelse(line_number02 != "", "Section 3 Malaria Screening",
ifelse(complete03 != "", "Visitors",
ifelse( complete11 != "","Net Inspection",
ifelse(complete06 != "" , "Tfhi",
ifelse(complete07 != "", "Vh", ""))))))) %>%
select(serial_number, repeat_instrument, everything())
hh_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
individual_answers <- Kano_data_modified %>%
# household level information
group_by(serial_number) %>%
slice(-1) %>%
ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
hh_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Household List") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
visitos_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Vh") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
dim(visitos_individual_answers)
Tfhi_individual_answers <- individual_answers %>%
# traveller's  data
filter(repeat_instrument == "Tfhi") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
dim(Tfhi_individual_answers)
visitos_individual_answers <- individual_answers %>%
# individual level data
filter(repeat_instrument == "Visitors") %>%
# ungroup %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
write.csv(visitos_individual_answers, file.path(cleaned_data,  metropolis_name,
"Kano_Visitors_level_information.csv"))
Tfhi_individual_answers <- individual_answers %>%
# traveller's  data
filter(repeat_instrument == "Tfhi") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
write.csv(Tfhi_individual_answers, file.path(cleaned_data,
"Kano_traveller_two_qtns_information.csv"))
write.csv(visitos_individual_answers, file.path(cleaned_data,  metropolis_name,
"Kano_Visitors_level_information.csv"))
Tfhi_individual_answers <- individual_answers %>%
# traveller's  data
filter(repeat_instrument == "Tfhi") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
write.csv(Tfhi_individual_answers, file.path(cleaned_data,  metropolis_name,
"Kano_traveller_two_qtns_information.csv"))
Vh_individual_answers <- individual_answers %>%
# visitors related  data
filter(repeat_instrument == "Vh") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
write.csv(Vh_individual_answers, file.path(cleaned_data, metropolis_name,
"Kano_traveller_one_qtns_information.csv"))
malaria_individual_answers <- individual_answers %>%
# malaria related  data
filter(repeat_instrument == "Section 3 Malaria Screening") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
malaria_individual_answers <- individual_answers %>%
# malaria related  data
filter(repeat_instrument == "Section 3 Malaria Screening") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(unique_id = paste0(serial_number, "_", line_number01))
names(individual_answers)
malaria_individual_answers <- individual_answers %>%
# malaria related  data
filter(repeat_instrument == "Section 3 Malaria Screening") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
View(malaria_individual_answers)
malaria_individual_answers <- individual_answers %>%
# malaria related  data
filter(repeat_instrument == "Section 3 Malaria Screening") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != ""))) %>%
mutate(unique_id = paste0(serial_number, "_", line_number02))
dim(malaria_individual_answers)[1] - unique(malaria_individual_answers$unique_id)
dim(malaria_individual_answers)[1] - length(unique(malaria_individual_answers$unique_id))
malaria_individual_answers)[1]
dim(malaria_individual_answers)[1]
1077/11009
1077/11009 * 100
186/7000 * 100
malaria_individual_answers_noconsent <-malaria_individual_answers %>%
filter(str_detect(unique_id, "_$"),
request_consent == "No",
consent_rdt == "No")
View(malaria_individual_answers_noconsent)
malaria_individual_answers <- individual_answers %>%
# malaria related  data
filter(repeat_instrument == "Section 3 Malaria Screening") %>%
select(where(~ any(!is.na(.)))) %>%
select(where(~ any(. != "")))
malaria_individual_answers_duplicates <- malaria_individual_answers %>%
# talk to eniola about this
group_by(unique_id) %>%
filter(n() > 1) %>%
ungroup()
malaria_individual_answers_duplicates <- malaria_individual_answers %>%
# talk to eniola about this
group_by(serial_number, line_number02, dbs_code) %>%
filter(n() > 1) %>%
ungroup()
malaria_individual_answers_duplicates
Kano_data <- read_dta(file.path(dropbox, "KN Wet season household malaria screening.dta"))
library(haven)
Kano_data <- read_dta(file.path(dropbox, "KN Wet season household malaria screening.dta"))
View(Kano_data )
Kano_data <- read_dta(file.path(dropbox, "KN wet season household list wt xteristics.dta"))
Kano_data_malaria_screening <- read_dta(file.path(dropbox, "KN Wet season household malaria screening.dta"))
Kano_data_hh_individuals <- read_dta(file.path(dropbox, "KN wet season household list wt xteristics.dta"))
View(Kano_data_malaria_screening)
dim(Kano_data_malaria_screening)
?look_up
?lookup
?haven
lookup[Kano_data_malaria_screening$q300i]
install.packages("qdapTools")
qdapTools::lookup(Kano_data_malaria_screening$q300i)
qdapTools::lookup(Kano_data_malaria_screening)
names(Kano_data_malaria_screening)
names(malaria_individual_answers)
names(Kano_data_malaria_screening)
names(Kano_data_malaria_screening) <-  c("serial_number", "repeat_instrument", "repeat_instance",
"request_consent",  "line_number02", "consent_rdt", "rdt_test_result" ,
"dried_blood_sample" ,"dbs_code" ,"interviwer_name"  ,"complete00")
Kano_data_hh_individuals
names(Kano_data_hh_individuals)
View(Kano_data_hh_individuals)
length(c("serial_number", "repeat_instrument", "repeat_instance",
"line_number01", "household_residents", "relationship_head_household",
"gender", "age", "dob", "mother_present", "marital_status", "rdt_eligibility",
"complete02", "lga", "ward", "settlement_type", "enumaration_area",
"hh_number", "longitude", "latidude", "name_household_head", "number_duplicated"))
length(names(Kano_data_hh_individuals))
names(Kano_data_hh_individuals) <-c("serial_number", "repeat_instrument", "repeat_instance",
"line_number01", "household_residents", "relationship_head_household",
"gender", "age", "dob", "mother_present", "marital_status", "rdt_eligibility",
"complete02", "lga", "ward", "settlement_type","community_name", "enumaration_area",
"hh_number", "longitude", "latidude", "name_household_head", "number_duplicated")
dim(Kano_data_hh_individuals)
dim(Kano_data_malaria_screening)
Kano_data_hh_individuals_cleaned <- Kano_data_hh_individuals %>%
# clean out the weird serial number
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
Kano_data_malaria_screening_cleaned <- Kano_data_malaria_screening %>%
# clean out the weird serial number
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
Kano_data_hh_individuals_cleaned <- Kano_data_hh_individuals %>%
# clean out the weird serial number
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number)))) %>%
Kano_data_malaria_screening_cleaned <- Kano_data_malaria_screening %>%
# clean out the weird serial number
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))))
Kano_data_hh_individuals_cleaned <- Kano_data_hh_individuals %>%
# clean out the weird serial number
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))),
unique_id = paste0(serial_number, "_", line_number01))
Kano_data_malaria_screening_cleaned <- Kano_data_malaria_screening %>%
# clean out the weird serial number
mutate(serial_number = ifelse(serial_number == "Muhammad", "00001",
ifelse(serial_number == "Household", "00002",
ifelse(serial_number == "HASSANA AHMAD", "00003",serial_number))),
unique_id = paste0(serial_number, "_", line_number02))
malaria_individual_answers_duplicates <- Kano_data_hh_individuals_cleaned %>%
# duplicates in Kano_data_hh_individuals_cleaned talk to eniola about this
group_by(serial_number, line_number02, dbs_code) %>%
filter(n() > 1) %>%
ungroup()
malaria_individual_answers_duplicates <- Kano_data_hh_individuals_cleaned %>%
# duplicates in Kano_data_hh_individuals_cleaned talk to eniola about this
group_by(serial_number, line_number02, unique_id) %>%
filter(n() > 1) %>%
ungroup()
malaria_individual_answers_duplicates <- Kano_data_hh_individuals_cleaned %>%
# duplicates in Kano_data_hh_individuals_cleaned talk to eniola about this
group_by(serial_number, line_number01, unique_id) %>%
filter(n() > 1) %>%
ungroup()
malaria_individual_answers_duplicates
View(unique_id)
View(malaria_individual_answers_duplicates)
malaria_malaria_screen_duplicates <- Kano_data_malaria_screening_cleaned %>%
# duplicates in Kano_data_hh_individuals_cleaned talk to eniola about this
group_by(serial_number, line_number01, dbs_code, unique_id) %>%
filter(n() > 1) %>%
ungroup()
malaria_malaria_screen_duplicates <- Kano_data_malaria_screening_cleaned %>%
# duplicates in Kano_data_hh_individuals_cleaned talk to eniola about this
group_by(serial_number, line_number02, dbs_code, unique_id) %>%
filter(n() > 1) %>%
ungroup()
malaria_malaria_screen_duplicates
View(malaria_malaria_screen_duplicates)
